= Proposed collaborative PP-Module for Continuous Multi-Factor Authentication enrolment and verification Overview
:showtitle:
:toc:
:toclevels: 3
:sectnums:
:sectnumlevels: 5
:imagesdir: images
:revnumber: 1.1
:revdate: November 9, 2021
:doctype: book

:iTC-longame: Biometrics Security
:iTC-shortname: BIO-iTC

== Document Description
This is an overview of a proposed collaborative Protection Profile Module (PP-Module) used to extend a Base-PP for a computer that implements Continuous Multi-Factor Authentication (CMFA) to keep the computer in the unlocked state using a collection of CMFA inputs. Therefore, the Target of Evaluation (TOE) in this PP-Module is a computer that implements CMFA functionality. However, the terms TOE and TOE environment in this document expresses the CMFA system that implements the continuous authentication functionality, and the computer that supports the CMFA system to protect the CMFA data respectively, for clearly describing the relation and boundary between the CMFA system and computer. The CMFA enrolment and verification processes are described in the following sections. 

== CMFA (TOE) Overview

CMFA is intended as a system for maintaining the identity of a user on a computer after the initial user authentication credentials have been entered into the computer. The CMFA system works in the background to maintain a level of trust about whether the computer is still in the possession of the authenticated user. This is done by utilizing information from a variety of sources available to the computer, and then combining this input to create a score about the confidence the computer is still in the possession of that user. The score is meant to be dynamic, being updated on a constant basis (within the limits of usability on the computer), so the level of confidence is accurate to the moment in time.

CMFA as defined here is specifically defined as a system on which to determine this confidence (referenced as the Trust Score) using the available inputs (as determined by the device and administrator). The Trust Score is the output of the CMFA system; the actions that should happen based on that Trust Score are handled by the computer directly. This is similar to how biometric authentication systems are generally configured; the authentication system asks the biometric subsystem to determine whether a user's identity is valid and a result is provided back to the authentication system. The main difference with CMFA is that while a biometric system is generally a yes/no result about the user's identity, the CMFA Trust Score provides a range (such as a 100 point scale) that can be used to provide confidence to the computer's system.

In practice this means that the actions of the device are not directly determined by the CMFA system, but are implemented by the computer's authentication system based on the Trust Score and the configured threshold values that specify actions the system must take. This division ensures that the CMFA system is able to work solely in the background with no direct user interaction (once enrolment/training has been completed). If the Trust Score has dropped below a specified threshold and the computer is locked by the authentication system, it is the authentication system that determines the user must enter new credentials (i.e. biometric/password/PIN as specified in FIA_UAU.5 in the Base-PP) to unlock the computer. The act of entering these credentials successfully would be recorded by the CMFA in the background to increase the Trust Score above that set threshold again.

=== CMFA Examples

There are many possible examples for CMFA usage on a computer. The key point to any of these is that the CMFA is only maintaining the Trust Score in the background, and it is up to the computer to determine what actions to take based on the value of the Trust Score.

The examples here are meant to show a range of options for the use of the CMFA output but are not meant to be exhaustive or even necessarily what is mandatory for use.

. *Maintain Computer Unlock* - this is the simplest case, where as long as the Trust Score is above a threshold value, the computer is maintained in an unlocked state (so the user is not prompted for direct authentication credential entry)
. *Sensitive Data Protection Lock/Computer Unlock* - this is an expansion of #1 with the additional function that if the Trust Score falls below a higher level, that SDP data (defined in the PP_MDF) would lock, while still maintaining the computer unlock for everything else. For example a score of 85 is needed to keep SDP unlocked, and a Trust Score of 70 is needed to keep the computer unlocked. Above 85 everything is available, below 70 the whole computer is locked, but between 85 and 70, SDP is locked while everything else on the computer remains available.
. *Time-Delay Lock* - this is a case where the Trust Score may fall below the threshold, but instead of an immediate lock action, the CMFA engine will check to see if an action happens within a period of time to raise the score back above the threshold, such as transiting between separate buildings on a campus (and losing Wi-Fi connectivity).
. *Rich Trust Score* - this is a scenario where more than just the Trust Score is available. The additional output could include information such as whether the computer is within a specific location, or any other combination of available information (such as analysis of signal combination subsets as opposed to the entire Trust Score).

=== TOE main security features

* enrolment
* verification
* updating the system based on new parameters
** for example geolocation tags when traveling to another office
* biometric update (later training period), after injury, other changes
* admin configuration
* user-authorized update (require password/PIN before allowing for user-requested change), configured by admin (allow/disallow)


This is a collaborative Protection Profile Module (PP-Module) used to extend a Base-PP for a computer that implements CMFA to keep the computer in the unlocked state using a collection of CMFA inputs. Therefore, the Target of Evaluation (TOE) in this PP-Module is a computer that implements CMFA functionality. However, the terms TOE and TOE environment in this document expresses the CMFA system that implements the continuous authentication functionality, and the computer that supports the CMFA system to protect the CMFA data respectively, for clearly describing the relation and boundary between the CMFA system and computer. The CMFA enrolment and verification processes are described in the following sections. 

==== CMFA Enrolment

During the enrolment process, the TOE captures characteristics to uniquely identify the user and creates a user profile. The TOE may capture samples from the biometric characteristics of the user presented to biometric sensors on the TOE (or utilize the results provided by a configured biometric sensor). The TOE may also extract other distinguishing features such as passwords, wireless signals within range of the TOE, behavioral patterns of the user, device activity, and other factors to determine the identity of the user. The user’s captured data is used to create a profile that can verify the user at a later time. A user or administrator may be able to revoke or change a user’s profile data (or the configuration used to create the profile data) that is captured by the TOE.

The enrolment process for CMFA may, depending on the configuration, take time to complete. Some biometric sensors may take time to learn (such as gait), or location information may be needed over time to provide the proper scoring. This period would be define at the start of the enrolment process.

==== CMFA Verification

Continuous verification in the context of CMFA is a passive activity from the user's perspective. No overt authentication related action is required by the user to determine CMFA status. From the user's perspective, they are merely using the computer for its intended purposes. During the verification process, a user's CMFA verification input signals are periodically sampled by the CMFA TOE. The user is not prompted to provide any of these input signals. The TOE collects these data as needed from the computer/sensors whether or not the user is interacting with the computer. Each CMFA input signal is individually tested for quality and veracity according to each signal's defined standards as prescribed by the TOE vendor and selected by the CMFA Administrator. The CMFA engine calculates a score based on all available input data that meets prescribed data quality and veracity metrics to determine a Trust score. The Trust score, threshold value and possibly other relevant information is made available to the computer for use in determining security-related actions.

CMFA related signals include all the input signals available to the TOE as defined by the TOE vendor. Some or all available CMFA signals may be selected by the CMFA administrator for use in calculating the Trust score for a given use case. Data provided by these signals can include user biometric information, wireless signal information (BT, Wi-Fi, NFC, etc.), location, on body status, local time, various computer status information, information from external devices such as wearables that are paired with the computer, and others. CMFA signal selection may be static or dynamic. Static selections are made by the CMFA administrator and remain fixed until changed by the administrator. Dynamic selections are set by the administrator but can change according to changes in the computer status such as time of day, location, wireless signal strength, connected network ID, user request for change, etc. Limits on what is permitted to change and by how much are set by the administrator.

=== CMFA Management
The configuration of CMFA is more complicated than single-factor authentication methods such as biometrics or passwords. Not only does it require the specification of the signals to be used by the CMFA Engine, the use of those signals must be configured. In addition to the configuration required by the administrator, the end user will need to provide training information (some of which may be collected over a period of time) to fully configure the CMFA for use.

CMFA management is expected to rely on the device management system to receive configuration policies. The device managmenet system is relied upon to ensure the policy is trusted from the corresponding EMM. The actual CMFA policy on the device will be maintained within the SEE of the system.

==== CMFA Policy Settings
A CMFA policy would have a number of settings governing the overall configuration of the CMFA Engine. 

NOTE: The options here are meant to be representative, but not exhaustive.

* Frequency of input checks (where applicable)
* Inputs to be used
** Mandatory inputs
** Optional/Selectable (per device capability) inputs
* Input configurations (examples below)
** Trusted Wi-Fi network(s)
** Trusted location(s)
** Time period when usable
* Trust settings for inputs
* Score settings
** parameters for combined inputs (i.e. location + time + Wi-Fi = good, vs just checking general parameters)
* Training parameters
** Length of training needed
** Forced user enrolment (where applicable)
** User information requests

==== CMFA Training
In addition to configuring the system settings, the user may have specific actions to perform tasks to complete the enrolment process. Until the user has provided the training/enrolment/responses needed, the CMFA authentication template cannot be completed.

NOTE: The options here are meant to be representative, but not exhaustive.

* Enrol a biometric
* Confirm a timezone
* Confirm a location (i.e. office/work location)
* Train a longer-term biometric (such as gait)
* Approve/confirm device connections (i.e. Bluetooth devices)

=== CMFA User Auth Update
* updating the user template, by either admin directly or some sort of user-requested authorization
* management functions that are specific to a single user

=== TOE Design
The TOE is fully integrated into the computer without the need for additional software and hardware. The following figure, inspired from <<ISO/IEC 30107-1>>, is a generic representation of a TOE. It should be noted that the actual TOE design may not directly correspond to this figure and the developer may design the TOE in a different way. This illustrates the components that a CMFA system will rely on for enrolment and verification processes.

[#img-TOE-generic]
.Generic representation of a TOE
image::TOE.png[title="Generic representation of a TOE" align="center"]
{empty} +
As illustrated in the above figure, the TOE is comprised of:

* CMFA Engine - the core service of the CMFA that determines the authentication Score based on the user's profile (and will generate the profile during enrolment) based on the policy specified by the administrator
* CMFA Signal Verification - this filters input and associates Trust values with the incoming data. Additional processing may be done on an input related to the Trust value
* Policy Engine - this applies the configuration specified by the administrator (it does not perform any authentication processing)

Additionally there are external components used by the TOE:

* External Admin - this is how the administrator generates a CMFA policy (for example via an EMM or a special local app)
* External Devices - devices that may be attached to the computer (likely wireless, but could also be wired)
* Wireless Signals - wireless connections available to the computer such as Wi-Fi networks, Bluetooth or cellular (not exhaustive)
* Sensors (general) - sensors on the computer such as location, on-body detection, etc.
* Biometric Sensors (Trusted and Untrusted) - various biometric sensors that are available on the computer which may or may not be evaluated to the BIO-PPM
* On-board Status - information internal to the device such as time, special keys, etc

* Capturing samples from user's biometric characteristics (Data Capture Subsystem)

The TOE verification flow can be represented roughly as this:

[#img-TOE-verification]
.Verification flow
image::verification.png[title="Verification flow" align="center"]

* Based on either time or a system change event (such as (dis)connecting to a Wi-Fi network), the CMFA will initiate reading of inputs (as specified in the CMFA policy)
* The inputs will be verified
* The CMFA engine will check the current authentication policy
* Using the current policy a profile will be generated based on the collected inputs
* The collected profile will be compared to the stored user profile
* The CMFA engine will generate a Score and based on that value determine whether the user is still verified
* The decision and Score are made available to the main Operating System to detemine any actions to be taken on the computer

An example of how a CMFA score would change over time can be seen here:

[#img-timeline]
.CMFA Score Timeline
image::timeline.png[title="CMFA Score Timeline" align="center"]

==== Relation between TOE and Computer 
The TOE is reliant on the computer itself to provide overall security of the system. This PP-Module is intended to be used with a Base-PP, and the Base-PP is responsible for evaluating the following security functions:

* Providing the NBAF to support user authentication and management of the TOE security function
* Invoking the TOE to enrol and verify the user and take appropriate actions based on the decision of the TOE
* Providing the Separate Execution Environment (SEE) that guarantees the TOE and its data to be protected with respect to confidentiality and integrity

The specification of the above security  functions are described in the Base-PP and <<PP_MDF Security Functional Requirements Direction>> of this PP-Module.
 
[#img-TOE-relations] 
.Generic relations between the TOE and the computer environment
image::TOE-operating-env.png[title="Generic relation between the TOE and the computer" align="center"]

==== TOE Use Case
The computer itself may be operated in a number of use cases such as enterprise use with limited personal use or Bring Your Own Device (BYOD). The TOE on the computer may also be operated in the same use cases, however, use cases of the TOE should be devised separately considering the purpose of biometric verification. The following use cases describe how and why biometric verification is supposed to be used. Each use case has its own assurance level, depending on its criticality and separate PP or PP-Module should be developed for each use case. 

This PP-Module only assumes USE CASE 1 described below. USE CASE 2 is out of scope of this PP-Module.

===== USE CASE 1: CMFA verification for maintaining the unlocked state on the computer
This use case is applicable for any computers such as a desktop, laptop, tablet or smartphone that implement biometric enrolment and verification functionality. For enhanced security that is easy to use, the computer may implement biometric verification on a computer once it has been “unlocked”. The initial unlock is generally done by a NBAF which is required at startup (or possibly after some period of time), and after that, the user is able to use one's own biometric characteristic to unlock access to the computer. In this use case, the computer is not supposed to be used for security sensitive services through the biometric verification.

The main concern of this use case is the accuracy of the biometric verification (i.e. FAR/FMR and FRR/FNMR). Security assurance for computer that the TOE relies on should be handled by the Base-PP.

This use case assumes that the computer is configured correctly to enable the biometric verification by the user, who acts as the biometric system administrator in this use case.

It is also assumed that the user enrols to the biometric system correctly, following the guidance provided by the TOE. Presentation attacks during biometric enrolment and verification may be out of scope, but optionally addressed. FTE is not a security relevant criterion for this use case.

===== USE CASE 2: CMFA verification for security sensitive service

This use case is an example of another use case that is not considered in this PP-Module. Another PP or PP-Module should be developed at higher assurance level for this use case.

Computers may be used for security sensitive services such as payment transactions and online banking. Verification may be done by the biometric for convenience instead of the NBAF to access such security sensitive services.

The requirements for the TOE focus on the biometric performance (FTE, FAR/FMR and FRR/FNMR) and presentation attack detection.

===== USE CASE 3: CMFA verification used to unlock external services
* for example using the score data to authorize unlocking a door


== Security Functional Requirements

=== Conventions
The individual security functional requirements are specified in the sections below.
The following conventions are used for the completion of operations:

* [_Italicized text within square brackets_] indicates an operation to be completed by the ST author.

* [*Bold text within square brackets*] indicates the type of operation.

Extended SFRs are identified by having a label “EXT” at the end of the SFR name.

=== PP_MDF Security Functional Requirements Direction

In a PP-Configuration that includes the <<PP_MDF>>, the biometric enrolment and verification is expected to rely on some of the security functions implemented by the computer as a whole and evaluated against the Base-PP. In this case, the following sections describe any modifications that the ST author must make to the SFRs defined in the Base-PP in addition to what is mandated by <<TOE Security Functional Requirements>>. 

Full evaluation activities are not repeated in the <<BIOSD>> for the requirements in this section that are references to the <<PP_MDF>>; only the additional testing needed to supplement what has already been captured in the <<PP_MDF>> is included in the <<BIOSD>>

==== Modified SFRs

The SFRs listed in this section are defined in the <<PP_MDF>> and relevant to the secure operation of the biometric enrolment and verification. It is necessary for the ST author to complete selections and/or assignments for these SFRs in a specific manner in order to ensure that the functionality provided by the mobile device is consistent with the functionality required by the biometric enrolment and verification in order for it to conform to this PP-Module.

===== Class: Cryptographic Support (FCS)
This PP-Module does not modify SFRs in FCS class as it is defined in the <<PP_MDF>>. However, note that BAF must be illustrated in the key hierarchy diagram and all keys created upon successful biometric enrolment and verification must be generated, derived, combined, released and destroyed according to SFRs in this class.

===== FCS_CKM_EXT.4 Key Destruction [[FCS_CKM_EXT.4]]
This SFR is identical to what is defined in the <<PP_MDF>>. The change is to the application note.

*Application Note:* For the purposes of this requirement, plaintext keying material refers to authentication data, passwords, secret/private symmetric keys, private asymmetric keys, data used to derive keys, values derived from passwords, etc. *Biometric data used for enrolment or verification are considered critical security parameters that must be destroyed when no longer needed.*

*Application Note {counter:remark_count}*:: The Application Note following FCS_CKM_EXT.4.2 is modified to add the text to include biometric data as a critical security parameter to ensure it is handled properly by the TSF.

===== FPT_AEX_EXT.4 Domain Isolation [[FPT_AEX_EXT.4]]
This SFR is identical to what is defined in the <<PP_MDF>>. The change is to the application note.

*Application Note:* In addition to the TSF software (e.g., kernel image, device drivers, trusted applications) that resides in storage, the execution context (e.g., address space, processor registers, per-process environment variables) of the software operating in a privileged mode of the processor (e.g., kernel, *other processor modes*) *or on separate processors*, as well as the context of the trusted applications is to be protected. In addition to the software, any configuration information that controls or influences the behavior of the TSF *and any hardware (e.g. biometric capture sensor) that generates or accesses the biometric data* is also to be protected from modification *or unauthorized access* by untrusted subjects.

*Application Note {counter:remark_count}*:: This application note explicitly adds more support for additional processor modes (e.g. the Secure/Normal World modes defined in a Trusted Execution Environment) or separate processors (e.g. a secure element) that may be present and used for the processing of biometric data. Any biometric components depicted in <<Figure 1>> should be considered as TSF being protected by these mechanisms, defined as the SEE.

===== FPT_KST_EXT.1 Key Storage [[FPT_KST_EXT.1]]

*FPT_KST_EXT.1.1*:: The TSF shall not store any plaintext key material *or biometric data* in readable non-volatile memory.

*Application Note {counter:remark_count}*:: This SFR is functionally identical to what is defined in the <<PP_MDF>> with the addition of biometric data as key materials to be protected. Plaintext biometric data to be protected includes any data used for the biometric enrolment and verification.

===== FPT_KST_EXT.2 No Key Transmission [[FPT_KST_EXT.2]]

*FPT_KST_EXT.2.1*:: The TSF shall not transmit any plaintext key material *or biometric data* outside the security boundary of the TOE.

*Application Note {counter:remark_count}*:: This SFR is functionally identical to what is defined in the <<PP_MDF>> with the addition of biometric data as plaintext key materials that must not be transmitted off-device. 

==== Additional SFRs

There are no additional SFRs that must be claimed only in cases where the <<PP_MDF>> is the claimed Base-PP.

=== TOE Security Functional Requirements
This section lists SFRs for the biometric enrolment and verification.

==== Cryptopgraphic Operations (FCS)
* consider what base-PP SFRs may be mandatory for functionality
* see if anything not covered in base-PP is needed

==== User Data Protection (FDP)

* Access control policy/functions
* information flow control/functions
??

==== Identification and Authentication (FIA)

===== FIA_MBE_EXT.1 Biometric enrolment [[FIA_MBE_EXT.1]]

*FIA_MBE_EXT.1.1*:: The TSF shall provide a mechanism to enrol an authenticated user.


===== FIA_MBE_EXT.2 Quality of biometric templates for biometric enrolment [[FIA_MBE_EXT.2]]

*FIA_MBE_EXT.2.1*:: The TSF shall only use biometric samples of sufficient quality for enrolment. Sufficiency of sample data shall be determined by measuring sample with [*selection*: [[*assignment*: _quality metric standard_] using a threshold of [*assignment*: _quality metric threshold_]], [*assignment*: _developer defined quality assessment method_]].


===== FIA_MBV_EXT.1 Biometric verification [[FIA_MBV_EXT.1]]

*FIA_MBV_EXT.1.1*:: The TSF shall provide a biometric verification mechanism using [*selection*: _eye, face, fingerprint, vein_].

*FIA_MBV_EXT.1.2*:: The TSF shall provide a biometric verification mechanism with the [*selection*: _FMR, FAR_] not exceeding [*assignment*: _value equal to or less than 0.01% (1:10^4^)_] for the upper bound of [*assignment*: _value equal to or greater than 80%_] confidence interval and, [*selection*: _FNMR, FRR_] not exceeding [*assignment*: _value equal to or less than 5% (5:100)_] for the upper bound of [*assignment*: _value equal to or greater than 80%_] confidence interval.


===== FIA_MBV_EXT.2 Quality of biometric samples for biometric verification [[FIA_MBV_EXT.2]]

*FIA_MBV_EXT.2.1*:: The TSF shall only use biometric samples of sufficient quality for verification. Sufficiency of sample data shall be determined by measuring sample with [*selection*: [[*assignment*: _quality metric standard_] using a threshold of [*assignment*: _quality metric threshold_]], [*assignment*: _developer defined quality assessment method_]].


==== Security Management

* Management of functions
* Management of Security Attributes
* Specification of management functions?


==== Privacy

* not sure here, but likely something (may need to be EXT)

==== Protection of the TSF (FPT)

* replay?
* time stamps (device dependency)
* self test?
* fail secure (is this applicable, it may be useful to show failure would go to say password or something)


===== FPT_BDP_EXT.1 Biometric data processing [[FPT_BDP_EXT.1]]

*FPT_BDP_EXT.1.1*:: Processing of plaintext biometric data shall be inside the SEE in runtime.


*FPT_BDP_EXT.1.2*:: Transmission of plaintext biometric data between the capture sensor and the SEE shall be isolated from the main computer operating system on the TSF in runtime.


===== FPT_PBT_EXT.1 Protection of biometric template [[FPT_PBT_EXT.1]]

*FPT_PBT_EXT.1.1*:: The TSF shall protect the template [*selection*: _using a PIN as an additional factor, using a password as an additional factor_, [*assignment*: _other circumstances_]].

==== Trusted Path/Channels

* is this useful to show some paths to the CMFA engine? Trust?


== Optional Requirements
This section comprises requirements that can be included in the ST, but are not mandatory for a TOE to claim conformance to this PP-Module.

ST authors are free to choose none, some or all SFRs defined in this Section. Just the fact that a product supports a certain functionality does not mandate to add any SFR defined in this chapter.

=== Identification and Authentication (FIA)

==== FIA_MBE_EXT.3 Presentation attack detection for biometric enrolment [[FIA_MBE_EXT.3]]

*FIA_MBE_EXT.3.1*:: The TSF shall prevent use of artificial presentation attack instruments from being successfully enroled.

==== FIA_MBV_EXT.3 Presentation attack detection for biometric verification [[FIA_MBV_EXT.3]]

*FIA_MBV_EXT.3.1*:: The TSF shall provide a biometric verification mechanism with the IAPAR not exceeding [*assignment*: _value equal to or less than 15% (15:100)_] to prevent use of artificial presentation attack instruments from being successfully verified.
